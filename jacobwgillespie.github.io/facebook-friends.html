<html>
<head>
  <title>Top Facebook Friends</title>
  <link rel="stylesheet" type="text/css" href="/css/normalize.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <link rel="stylesheet" type="text/css" href="/css/jqcloud.css" />
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script src="/js/jqcloud.js"></script>
</head>
<body>

<script type="text/javascript">
var buildData = function() {
  var data = $('#code').val();
  data = data.replace('for (;;);', '');
  data = $.parseJSON(data);
  data = data.payload.entries;
  data = $.grep(data, function(el, id) {
    return (el.type === 'user');
  });
  data = $.map(data, function(el, id){
    var score;
    if (el.grammar_costs)
      score = (1 - el.grammar_costs['{user}']) * 10;
    else
      score = el.index;
    return {text: el.text, weight: Math.abs(score), html: {title: el.text + ' has a score of ' + Math.abs(score)}};
  });
  return data;
};

$(function() {
  $('#build-button').on('click', function() {
    try {
      var data = buildData();
      $("#facebook-friends").jQCloud(data.slice(0,50), {});
      $("#facebook-friends-list").val('');
      data.forEach(function(user) {
        var val = $("#facebook-friends-list").val();
        $("#facebook-friends-list").val(val + user.text + ' ' + user.weight + "\n");
      });
      $('#build-button').remove();
    } catch (e) {
      alert('Whoops - did you copy and paste the entire contents of that page?');
    }
  });
});
</script>

<p>Facebook computes a numeric score for your top friends - which is fun, but it's much more fun to see it as a graph!  Use the below tool to view yours:</p>

<p><strong>NOTE:</strong> parts of this either don't work or are hard to use in Internet Explorer - it is <em>strongly</em> recommended that you try this in a <a href="https://www.google.com/chrome">modern browser</a> like Google Chrome, Firefox, or Safari.</p>

<ol>
  <li>Drag this link to your bookmarks bar: <a href="javascript:if%20(window.location.href.match(%2Ffacebook.com%2F))%7Bwindow.location%3D'https%3A%2F%2Fwww.facebook.com%2Fajax%2Ftypeahead%2Fsearch%2Fbootstrap.php%3F__a%3D1%26filter%5B0%5D%3Duser%26lazy%3D0%26token%3Dv7%26stale_ok%3D0%26viewer%3D'%2B(document.body.innerHTML.match(%2Fviewer%22%3A(%5B%5E%2C%5D%2B)%2C%2F)%5B1%5D)%3B%7Delse%7Balert('Please%20visit%20Facebook%20before%20clicking%20this%20button')%3B%7D" onclick="alert('Please drag this link to your bookmarks bar');return false;">Get My Top Friends</a></li>
  <li>Go to <a href="https://www.facebook.com" target="_blank">Facebook</a>.  While on Facebook, click on <strong>Get My Top Friends</strong> in your bookmarks bar</li>
  <li>You will (hopefully) see a lot of code. Copy and paste the <em>entire</em> contents of the page into the box below (using <tt>Control-A</tt> then copy, for example)</li>
  <li>If instead of seeing a lot of code, it asks you to open or download a file, then open it and copy and paste the code from there</li>
  <li>Click on <strong>Build Graph</strong> below...  Enjoy!</li>
  <li>Optional: you can take a screenshot of this page to save it to your computer</li>
</ol>

<div>
  <label>
    Facebook Friend Code<br />
    <textarea style="width:100%;" id="code" rows="5"></textarea>
  </label>
  <br />
  <button type="button" id="build-button">Build Graph</button>
</div>

<h3>Top 50 Friends</h3>

<fb:like href="https://jacobwg.com/facebook-friends/" send="true" width="640" show_faces="true" colorscheme="dark"></fb:like>

<div id="facebook-friends" style="width: 640px; height: 600px; border: 1px solid #ccc; background-color: #000"></div>

<p><strong>Data</strong></p>
<textarea id="facebook-friends-list" disabled style="width:100%;" rows="5"></textarea>

<p><strong>Explanation:</strong> The above graph represents your top 50 Facebook friends.  The larger a given friend's name is, the more Facebook considers that person someone who you care about.  The individual friend "score" is generated by Facebook through an algorithm that takes into account how much interaction you have with that given friend (like comments, posts, likes, viewing each other's profile, messages, etc.) as well as how you are related to that given friend (as family, via mutual friends, etc.).</p>

</body>
</html>
